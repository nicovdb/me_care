<% content_for :meta_title, "Dashboard | easy endo" %>
<div class="padding-top-navbar pb-5 min-100-vh-with-footer" data-controller='active-tab' data-active-tab-name='<%= params[:active] %>'>
  <div class="container text-green">
    <div class="col-12 col-md-10 offset-md-1">
      <div class="d-none d-md-block">
        <%= link_to dashboard_path do %>
          <span class="feature-name">Dashboard</span>
        <% end %>
      </div>

      <ul class="nav nav-tabs mt-md-4 mb-3" id="pills-tab" role="tablist">
        <li class="nav-item" role="presentation">
          <a class="nav-link active" id="pills-news-tab" data-toggle="pill" href="#pills-news" role="tab" aria-controls="pills-news" aria-selected="true" data-target="active-tab.linkNews" data-action="click->active-tab#openTab">News</a>
        </li>
        <li class="nav-item" role="presentation">
          <a class="nav-link" id="pills-infoendo-tab" data-toggle="pill" href="#pills-infoendo" role="tab" aria-controls="pills-infoendo" aria-selected="false" data-target="active-tab.linkInfoendos"  data-action="click->active-tab#openTab">À savoir</a>
        </li>
        <li class="nav-item" role="presentation">
          <a class="nav-link" id="pills-webinar-tab" data-toggle="pill" href="#pills-webinar" role="tab" aria-controls="pills-webinar" aria-selected="false" data-target="active-tab.linkEasylives"  data-action="click->active-tab#openTab">easy Live</a>
        </li>
        <li class="nav-item" role="presentation">
          <a class="nav-link" id="pills-forum-tab" data-toggle="pill" href="#pills-forum" role="tab" aria-controls="pills-forum" aria-selected="false" data-target="active-tab.linkForum"  data-action="click->active-tab#openTab">Forum</a>
        </li>
        <li class="nav-item" role="presentation">
          <a class="nav-link" id="pills-users-tab" data-toggle="pill" href="#pills-users" role="tab" aria-controls="pills-users" aria-selected="false" data-target="active-tab.linkUsers"  data-action="click->active-tab#openTab">Utilisateurs</a>
        </li>
      </ul>
      <div class="tab-content" id="pills-tabContent">
        <div class="tab-pane fade active show" id="pills-news" role="tabpanel" aria-labelledby="pills-news-tab" data-target="active-tab.contentNews">

          <div class="my-4">
            <div class="mb-3 d-flex align-items-center">
              <%= link_to '+ créer une news', new_dashboards_article_path, class:"mb-3" %>
            </div>
            <%= render 'articles' %>
          </div>
        </div>

        <div class="tab-pane fade" id="pills-webinar" role="tabpanel" aria-labelledby="pills-webinar-tab"  data-target="active-tab.contentEasylives">

          <div class="my-4">
            <div class="mb-3 d-flex align-items-center">
              <%= link_to '+ créer un webinar', new_dashboards_webinar_path, class:"mb-3" %>
            </div>
            <%= render 'webinars' %>
          </div>
        </div>
        <div class="tab-pane fade" id="pills-infoendo" role="tabpanel" aria-labelledby="pills-infoendo-tab"  data-target="active-tab.contentInfoendos">

          <div class="my-4">
            <div class="mb-3 d-flex align-items-center">
              <%= link_to '+ créer un à savoir', new_dashboards_infoendo_path, class:"mb-3" %>
            </div>
            <%= render 'infoendos' %>
          </div>
        </div>
        <div class="tab-pane fade" id="pills-forum" role="tabpanel" aria-labelledby="pills-forum-tab"  data-target="active-tab.contentForum">

          <div class="my-4">
            <div class="d-flex align-items-center">
              <%= link_to '+ créer une catégorie', new_dashboards_forum_category_path, class:"mb-2" %>
            </div>
            <div class="d-flex align-items-center">
              <%= link_to '+ créer un sujet', new_dashboards_subject_path, class:"mb-2" %>
            </div>
            <%= render 'forum' %>
          </div>
        </div>
        <div class="tab-pane fade" id="pills-users" role="tabpanel" aria-labelledby="pills-users-tab"  data-target="active-tab.contentUsers">

          <div class="my-4">
            <div class="d-flex align-items-center">
              <%= form_tag become_admin_path, method: :patch do %>
                <div>
                  <%= collection_select :user,
                    :id,
                    User.all,
                    :id,
                    :full_name
                  %>
                </div>
                <div>
                  <%= submit_tag "Donner rôle admin", class: "btn btn-primary" %>
                </div>
              <% end %>
            </div>
            <h3 class='mt-4'><strong> Utilisateurs avec droits d'administrateur :</strong></h3>
            <% @admins.each do |user| %>
            <div class="d-flex">
              <p class='mb-0 mr-2'><%= user.full_name%></p>
              <%= link_to "X", undo_admin_path(user), method: :patch, data: {confirm: "Etes vous sûre de vouloir enlever les droit d'administrateur à cet utilisateur ?"}  %>
            </div>
            <% end %>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

